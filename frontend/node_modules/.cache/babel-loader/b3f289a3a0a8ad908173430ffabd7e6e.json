{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Alexander\\\\Desktop\\\\important\\\\ecommercedr\\\\frontend\\\\src\\\\containers\\\\Profile.js\";\nimport React from \"react\";\nimport { connect } from \"react-redux\"; // import { Redirect, useHistory } from \"react-router-dom\";\n\nimport { Button, Card, Dimmer, Divider, Grid, Header, Image, Label, Loader, Menu, Message, Segment } from \"semantic-ui-react\";\nimport { countryListURL, addressDeleteURL, userIDURL } from \"./constants\";\nimport { authAxios } from \"../Utils\";\nimport { fetchAddresses } from \"../store/actions/Address\";\nimport PaymentHistory from \"./PaymentHistory\";\nimport AddressForm from \"./AddressForm\";\nconst UPDATE_FORM = \"UPDATE_FORM\";\nconst CREATE_FORM = \"CREATE_FORM\";\nlet globalActiveItem = \"billingAddress\";\n\nclass Profile extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      activeItem: \"billingAddress\",\n      addresses: [],\n      countries: [],\n      userID: null,\n      selectedAddress: null\n    };\n\n    this.handleItemClick = name => {\n      this.setState({\n        activeItem: name\n      }, () => {\n        globalActiveItem = this.state.activeItem;\n        this.props.fetchAddresses();\n      });\n    };\n\n    this.handleGetActiveItem = () => {\n      const {\n        activeItem\n      } = this.state;\n\n      if (activeItem === \"billingAddress\") {\n        return \"Billing Address\";\n      } else if (activeItem === \"shippingAddress\") {\n        return \"Shipping Address\";\n      }\n\n      return \"Payment History\";\n    };\n\n    this.handleFormatCountries = countries => {\n      const keys = Object.keys(countries);\n      return keys.map(k => {\n        return {\n          key: k,\n          text: countries[k],\n          value: k\n        };\n      });\n    };\n\n    this.handleDeleteAddress = addressID => {\n      authAxios.delete(addressDeleteURL(addressID)).then(res => {\n        this.handleCallback();\n      }).catch(err => {\n        this.setState({\n          error: err\n        });\n      });\n    };\n\n    this.handleSelectAddress = address => {\n      this.setState({\n        selectedAddress: address\n      });\n    };\n\n    this.handleFetchUserID = () => {\n      authAxios.get(userIDURL).then(res => {\n        this.setState({\n          userID: res.data.userID\n        });\n      }).catch(err => {\n        this.setState({\n          error: err\n        });\n      });\n    };\n\n    this.handleFetchCountries = () => {\n      authAxios.get(countryListURL).then(res => {\n        this.setState({\n          countries: this.handleFormatCountries(res.data)\n        });\n      }).catch(err => {\n        this.setState({\n          error: err\n        });\n      });\n    };\n\n    this.handleCallback = () => {\n      this.props.fetchAddresses();\n      this.setState({\n        selectedAddress: null\n      });\n    };\n\n    this.renderAddresses = () => {\n      const {\n        activeItem,\n        addresses,\n        countries,\n        selectedAddress,\n        userID\n      } = this.state;\n      return /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Card.Group, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 9\n        }\n      }, this.props.addressesList.map(a => {\n        return /*#__PURE__*/React.createElement(Card, {\n          key: a.id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(Card.Content, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 17\n          }\n        }, a.default && /*#__PURE__*/React.createElement(Label, {\n          as: \"a\",\n          color: \"blue\",\n          ribbon: \"right\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 21\n          }\n        }, \"Default\"), /*#__PURE__*/React.createElement(Card.Header, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 19\n          }\n        }, a.street_address, \", \", a.apartment_address), /*#__PURE__*/React.createElement(Card.Meta, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 19\n          }\n        }, a.country), /*#__PURE__*/React.createElement(Card.Description, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 19\n          }\n        }, a.zip)), /*#__PURE__*/React.createElement(Card.Content, {\n          extra: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(Button, {\n          color: \"yellow\",\n          onClick: () => this.handleSelectAddress(a),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 19\n          }\n        }, \"Update\"), /*#__PURE__*/React.createElement(Button, {\n          color: \"red\",\n          onClick: () => this.handleDeleteAddress(a.id),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 19\n          }\n        }, \"Delete\")));\n      })), addresses.length > 0 ? /*#__PURE__*/React.createElement(Divider, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 33\n        }\n      }) : null, selectedAddress === null ? /*#__PURE__*/React.createElement(AddressForm, {\n        activeItem: activeItem,\n        countries: countries,\n        formType: CREATE_FORM,\n        userID: userID,\n        callback: this.handleCallback,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }\n      }) : null, selectedAddress && /*#__PURE__*/React.createElement(AddressForm, {\n        activeItem: activeItem,\n        userID: userID,\n        countries: countries,\n        address: selectedAddress,\n        formType: UPDATE_FORM,\n        callback: this.handleCallback,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }\n      }));\n    };\n  }\n\n  componentDidMount() {\n    this.props.fetchAddresses();\n    this.handleFetchCountries();\n    this.handleFetchUserID();\n  }\n\n  render() {\n    const {\n      activeItem,\n      error,\n      loading\n    } = this.state;\n    const {\n      isAuthenticated\n    } = this.props;\n\n    if (!isAuthenticated) {\n      this.props.history.push(\"/login\");\n    }\n\n    return /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      columns: 2,\n      divided: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Row, {\n      columns: 1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Column, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }\n    }, error && /*#__PURE__*/React.createElement(Message, {\n      error: true,\n      header: \"There was an error\",\n      content: JSON.stringify(error),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 15\n      }\n    }), loading && /*#__PURE__*/React.createElement(Segment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Dimmer, {\n      active: true,\n      inverted: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Loader, {\n      inverted: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 19\n      }\n    }, \"Loading\")), /*#__PURE__*/React.createElement(Image, {\n      src: \"/images/wireframe/short-paragraph.png\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }\n    })))), /*#__PURE__*/React.createElement(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Grid.Column, {\n      width: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Menu, {\n      pointing: true,\n      vertical: true,\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Menu.Item, {\n      name: \"Billing Address\",\n      active: activeItem === \"billingAddress\",\n      onClick: () => this.handleItemClick(\"billingAddress\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Menu.Item, {\n      name: \"Shipping Address\",\n      active: activeItem === \"shippingAddress\",\n      onClick: () => this.handleItemClick(\"shippingAddress\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Menu.Item, {\n      name: \"Payment history\",\n      active: activeItem === \"paymentHistory\",\n      onClick: () => this.handleItemClick(\"paymentHistory\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 15\n      }\n    }))), /*#__PURE__*/React.createElement(Grid.Column, {\n      width: 10,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 13\n      }\n    }, this.handleGetActiveItem()), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 13\n      }\n    }), activeItem === \"paymentHistory\" ? /*#__PURE__*/React.createElement(PaymentHistory, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 15\n      }\n    }) : this.renderAddresses())));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.auth.token !== null,\n    addressesList: state.address.addressList\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchAddresses: () => dispatch(fetchAddresses(globalActiveItem === \"billingAddress\" ? \"B\" : \"S\"))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Profile);","map":{"version":3,"sources":["C:/Users/Alexander/Desktop/important/ecommercedr/frontend/src/containers/Profile.js"],"names":["React","connect","Button","Card","Dimmer","Divider","Grid","Header","Image","Label","Loader","Menu","Message","Segment","countryListURL","addressDeleteURL","userIDURL","authAxios","fetchAddresses","PaymentHistory","AddressForm","UPDATE_FORM","CREATE_FORM","globalActiveItem","Profile","Component","state","activeItem","addresses","countries","userID","selectedAddress","handleItemClick","name","setState","props","handleGetActiveItem","handleFormatCountries","keys","Object","map","k","key","text","value","handleDeleteAddress","addressID","delete","then","res","handleCallback","catch","err","error","handleSelectAddress","address","handleFetchUserID","get","data","handleFetchCountries","renderAddresses","addressesList","a","id","default","street_address","apartment_address","country","zip","length","componentDidMount","render","loading","isAuthenticated","history","push","JSON","stringify","mapStateToProps","auth","token","addressList","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n// import { Redirect, useHistory } from \"react-router-dom\";\r\nimport {\r\n  Button,\r\n  Card,\r\n  Dimmer,\r\n  Divider,\r\n  Grid,\r\n  Header,\r\n  Image,\r\n  Label,\r\n  Loader,\r\n  Menu,\r\n  Message,\r\n  Segment,\r\n} from \"semantic-ui-react\";\r\nimport { countryListURL, addressDeleteURL, userIDURL } from \"./constants\";\r\nimport { authAxios } from \"../Utils\";\r\nimport { fetchAddresses } from \"../store/actions/Address\";\r\n\r\nimport PaymentHistory from \"./PaymentHistory\";\r\nimport AddressForm from \"./AddressForm\";\r\n\r\nconst UPDATE_FORM = \"UPDATE_FORM\";\r\nconst CREATE_FORM = \"CREATE_FORM\";\r\n\r\nlet globalActiveItem = \"billingAddress\";\r\n\r\nclass Profile extends React.Component {\r\n  state = {\r\n    activeItem: \"billingAddress\",\r\n    addresses: [],\r\n    countries: [],\r\n    userID: null,\r\n    selectedAddress: null,\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.props.fetchAddresses();\r\n    this.handleFetchCountries();\r\n    this.handleFetchUserID();\r\n  }\r\n\r\n  handleItemClick = (name) => {\r\n    this.setState({ activeItem: name }, () => {\r\n      globalActiveItem = this.state.activeItem;\r\n      this.props.fetchAddresses();\r\n    });\r\n  };\r\n\r\n  handleGetActiveItem = () => {\r\n    const { activeItem } = this.state;\r\n    if (activeItem === \"billingAddress\") {\r\n      return \"Billing Address\";\r\n    } else if (activeItem === \"shippingAddress\") {\r\n      return \"Shipping Address\";\r\n    }\r\n    return \"Payment History\";\r\n  };\r\n\r\n  handleFormatCountries = (countries) => {\r\n    const keys = Object.keys(countries);\r\n    return keys.map((k) => {\r\n      return {\r\n        key: k,\r\n        text: countries[k],\r\n        value: k,\r\n      };\r\n    });\r\n  };\r\n\r\n  handleDeleteAddress = (addressID) => {\r\n    authAxios\r\n      .delete(addressDeleteURL(addressID))\r\n      .then((res) => {\r\n        this.handleCallback();\r\n      })\r\n      .catch((err) => {\r\n        this.setState({ error: err });\r\n      });\r\n  };\r\n\r\n  handleSelectAddress = (address) => {\r\n    this.setState({ selectedAddress: address });\r\n  };\r\n\r\n  handleFetchUserID = () => {\r\n    authAxios\r\n      .get(userIDURL)\r\n      .then((res) => {\r\n        this.setState({ userID: res.data.userID });\r\n      })\r\n      .catch((err) => {\r\n        this.setState({ error: err });\r\n      });\r\n  };\r\n\r\n  handleFetchCountries = () => {\r\n    authAxios\r\n      .get(countryListURL)\r\n      .then((res) => {\r\n        this.setState({ countries: this.handleFormatCountries(res.data) });\r\n      })\r\n      .catch((err) => {\r\n        this.setState({ error: err });\r\n      });\r\n  };\r\n\r\n  handleCallback = () => {\r\n    this.props.fetchAddresses();\r\n    this.setState({ selectedAddress: null });\r\n  };\r\n\r\n  renderAddresses = () => {\r\n    const {\r\n      activeItem,\r\n      addresses,\r\n      countries,\r\n      selectedAddress,\r\n      userID,\r\n    } = this.state;\r\n    return (\r\n      <React.Fragment>\r\n        <Card.Group>\r\n          {this.props.addressesList.map((a) => {\r\n            return (\r\n              <Card key={a.id}>\r\n                <Card.Content>\r\n                  {a.default && (\r\n                    <Label as=\"a\" color=\"blue\" ribbon=\"right\">\r\n                      Default\r\n                    </Label>\r\n                  )}\r\n                  <Card.Header>\r\n                    {a.street_address}, {a.apartment_address}\r\n                  </Card.Header>\r\n                  <Card.Meta>{a.country}</Card.Meta>\r\n                  <Card.Description>{a.zip}</Card.Description>\r\n                </Card.Content>\r\n                <Card.Content extra>\r\n                  <Button\r\n                    color=\"yellow\"\r\n                    onClick={() => this.handleSelectAddress(a)}\r\n                  >\r\n                    Update\r\n                  </Button>\r\n                  <Button\r\n                    color=\"red\"\r\n                    onClick={() => this.handleDeleteAddress(a.id)}\r\n                  >\r\n                    Delete\r\n                  </Button>\r\n                </Card.Content>\r\n              </Card>\r\n            );\r\n          })}\r\n        </Card.Group>\r\n        {addresses.length > 0 ? <Divider /> : null}\r\n        {selectedAddress === null ? (\r\n          <AddressForm\r\n            activeItem={activeItem}\r\n            countries={countries}\r\n            formType={CREATE_FORM}\r\n            userID={userID}\r\n            callback={this.handleCallback}\r\n          />\r\n        ) : null}\r\n        {selectedAddress && (\r\n          <AddressForm\r\n            activeItem={activeItem}\r\n            userID={userID}\r\n            countries={countries}\r\n            address={selectedAddress}\r\n            formType={UPDATE_FORM}\r\n            callback={this.handleCallback}\r\n          />\r\n        )}\r\n      </React.Fragment>\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { activeItem, error, loading } = this.state;\r\n    const { isAuthenticated } = this.props;\r\n    if (!isAuthenticated) {\r\n      this.props.history.push(\"/login\");\r\n    }\r\n    return (\r\n      <Grid container columns={2} divided>\r\n        <Grid.Row columns={1}>\r\n          <Grid.Column>\r\n            {error && (\r\n              <Message\r\n                error\r\n                header=\"There was an error\"\r\n                content={JSON.stringify(error)}\r\n              />\r\n            )}\r\n            {loading && (\r\n              <Segment>\r\n                <Dimmer active inverted>\r\n                  <Loader inverted>Loading</Loader>\r\n                </Dimmer>\r\n                <Image src=\"/images/wireframe/short-paragraph.png\" />\r\n              </Segment>\r\n            )}\r\n          </Grid.Column>\r\n        </Grid.Row>\r\n        <Grid.Row>\r\n          <Grid.Column width={6}>\r\n            <Menu pointing vertical fluid>\r\n              <Menu.Item\r\n                name=\"Billing Address\"\r\n                active={activeItem === \"billingAddress\"}\r\n                onClick={() => this.handleItemClick(\"billingAddress\")}\r\n              />\r\n              <Menu.Item\r\n                name=\"Shipping Address\"\r\n                active={activeItem === \"shippingAddress\"}\r\n                onClick={() => this.handleItemClick(\"shippingAddress\")}\r\n              />\r\n              <Menu.Item\r\n                name=\"Payment history\"\r\n                active={activeItem === \"paymentHistory\"}\r\n                onClick={() => this.handleItemClick(\"paymentHistory\")}\r\n              />\r\n            </Menu>\r\n          </Grid.Column>\r\n          <Grid.Column width={10}>\r\n            <Header>{this.handleGetActiveItem()}</Header>\r\n            <Divider />\r\n            {activeItem === \"paymentHistory\" ? (\r\n              <PaymentHistory />\r\n            ) : (\r\n              this.renderAddresses()\r\n            )}\r\n          </Grid.Column>\r\n        </Grid.Row>\r\n      </Grid>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    isAuthenticated: state.auth.token !== null,\r\n    addressesList: state.address.addressList,\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n  return {\r\n    fetchAddresses: () =>\r\n      dispatch(\r\n        fetchAddresses(globalActiveItem === \"billingAddress\" ? \"B\" : \"S\")\r\n      ),\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Profile);\r\n"]},"metadata":{},"sourceType":"module"}